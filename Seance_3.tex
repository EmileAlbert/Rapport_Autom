\section{Séance 3 : Feed-Forward}
\subsection{Introduction}
Le but de la séance est d'utiliser la technique du \textbf{feed-forward}. Une action de ce type, si elle bien paramétrées, rend invisibles une perturbation pour la sortie du système. La perturbation étudiée sera un changement de vitesse du ventilateur. Elle se présentera sous la forme d'un échelon 50 à 60\% de la vitesse maximale dudit ventilateur.\\

Pour paramétrer ce type d'action, il est primordial d'avoir un régulateur optimisé. Sur base des essais réalisés au dernier laboratoire, plusieurs groupes de paramètres ont été testés pour tendre vers un régulateur efficace. Pour ce faire, il a été choisi de partir du régulateur testé lors de l'essai 1 de la première séance. À partir de ces paramètres, nous avons abouti sur un régulateur optimisé. Les résultats de cette démarche seront présentés sous forme d'une \textit{feuille de résultat} comprenant :
\begin{itemize}
\item Le graphe de la sortie du système 
\item Le graphe de la consigne de courant appliquée par le régulateur.
\item Les valeurs de constantes utilisées.
\item Les commentaires influençant le choix des constantes de l'essai suivant.
\end{itemize}

Lorsque l'on désire paramétrer une action en feed-forward, il est nécessaire de connaitre la fonction de transfert de la perturbation. Celle-ci sera obtenue au moyen d'un programme d'optimisation. Le point \ref{FW} détaillera de manière plus précise la manière d'utiliser ce type d'action.\\ 


\subsection{Optimisation du régulateur}
\begin{optibox}{essai1}{6}{150}{15}
On peut observer que la consigne de courant sature. De ce fait, on observe que le système tend vers la consigne mais en oscillant.  Il a été décidé de réaliser l'essai suivant en augmentant la valeur de la constante proportionnelle.
\\\hline
\end{optibox}

\begin{optibox}{essai2}{10}{150}{15}
La consigne de courant sature encore plus.
Cependant, les essais 3 à 12 ne seront pas présentés car ils sont contre-productifs. Une mauvaise compréhension de certains paramètres nous ont conduits à augmenter la valeur de $K_{p}$ jusque 30. Voyant que nous nous écartions d'une régulation efficace, il a été convenue de repartir de l'essai 1 pour poursuivre l'optimisation mais en diminuant seulement la valeur de $T_{d}$\\
\\\hline
\end{optibox}

\begin{optibox}{essai13}{6}{150}{8}
La consigne de courant ne sature plus mais on observe un grand dépassement. Les valeurs de $K_{p}$ et $T_{d}$ seront donc diminué pour l'essai suivant. La consigne n'étant pas atteinte après 270 secondes, l'essai a été avorté. 
\\\hline
\end{optibox}

\begin{optibox}{essai14}{4}{80}{8}
La consigne de température étant atteinte et le dépassement étant faible, la composante intégrative et le facteur de dérivation seront augmentés pour essayer d'accélérer la régulation du système.
 \\\hline
\end{optibox}

\begin{optibox}{essai15}{4}{65}{10}
La consigne de température est atteinte en deux oscillations et en 200 secondes. Pour diminuer l'oscillation on augmente encore le  $T_{d}$. On augmentera aussi un tout petit peu le facteur proportionnel pour diminuer en même temps le dépassement.\\\hline
\end{optibox}

\begin{optibox}{essai16}{4.5}{65}{15}
La sortie du système ne présente plus de dépassement mais la consigne est atteinte plus lentement qu'à l'essai précédent. La valeur de $T_{d}$ sera légèrement diminuée.
\\\hline
\end{optibox}

\begin{optibox}{essai17}{4.5}{65}{12.5}
Le dépassement est très faible et la température souhaitée est atteinte en moins de 200 secondes. 
Les paramètres de cet essai seront utilisés comme constantes du régulateur optimisé.
\\\hline
\end{optibox}


%DATA.
%\begin{itemize}
%\item $K_{p} = 20$, $T_{i} = 150$ et $T_{d} = 15$(4)
%\item $K_{p} = 15$, $T_{i} = 150$ et $T_{d} = 7$(5)
%\item $K_{p} = 10$, $T_{i} = 150$ et $T_{d} = 7$(6)
%\item $K_{p} = 10$, $T_{i} = 150$ et $T_{d} = 11$(7)
%\item $K_{p} = 12$, $T_{i} = 100$ et $T_{d} = 13$(8)
%\item $K_{p} = 17$, $T_{i} = 100$ et $T_{d} = 13$(9)
%\item $K_{p} = 20$, $T_{i} = 100$ et $T_{d} = 10$(10)
%\item $K_{p} = 25$, $T_{i} = 80$ et $T_{d} = 12$(11)
%\item $K_{p} = 35$, $T_{i} = 80$ et $T_{d} = 12$(12)
%\item $K_{p} = 6$, $T_{i} = 150$ et $T_{d} = 8$(13)\\
%\item $K_{p} = 4$, $T_{i} = 80$ et $T_{d} = 8$(14)
%\item $K_{p} = 4.5$, $T_{i} = 65$ et $T_{d} = 10$(15)
%\item $K_{p} = 4.5$, $T_{i} = 65$ et $T_{d} = 15$(16)
%\item \textbf{\textcolor{green}{$K_{p} = 4.5$, $T_{i} = 65$ et $T_{d} = 12.5$}}(17)
%\end{itemize}


\subsubsection{Fonction de transfert du système}


\subsection{Manipulation - Feed-Forward}
\label{FW}
Le but du feed-forward est de compenser la perturbation due à la vitesse du ventilateur en jouant sur le courant dans la résistance (en appliquant l'inverse de la fonction de la perturbation. Dans ce cas, la perturbation deviendrait quasi invisible sur la sortie.\\

La sortie est vue comme une combinaison de l'influence du courant dans la résistance chauffante et de la vitesse du ventilateur. Cette partie du système à une dynamique qui lui est propre ce qui implique de connaitre sa fonction de transfert. La figure \ref{} présente la réponse indicielle de la perturbation lorsqu'elle est placée dans le système ainsi que les paramètres caractérisant la fonction de transfert basé sur du modèle de Vander Grinten.\\

\fig{optimisation/H2.png}{0.6}{Recherche des paramètre de la fonction de transfert de la perturbation}

\subsubsection{Mise à jour du système}
\begin{figure}[h]

\input{Seance_2_SCH}
\caption{Schéma bloc du système avec le régulateur de suivis de consigne et de réjection des perturbations}
\end{figure}

Au vue du schéma, la perturbation devient une entrée pour le régulateur. La sortie  $y_{pv}$ est influencée par  $H_{1}$ et par $H_{2}$ et devient :\\

\begin{align}
y_{pv} &= u \cdot H_{1}(s) + d \cdot H_{2}(s)\\
	   &= d \cdot R_{2} \cdot H_{1} + d \cdot H_{2}\\
	   &= d \cdot (R_{2} \cdot H_{1} + H_{2})\\
\end{align}
Avec $R_{2}$ le deuxième régulateur connecté à la mesure de la perturbation et $d$ la perturbation (\textit{disturbate})
Comme l'impact sur la sortie doit être minimal, nous pouvons dire que $y_{pv}$ est considéré comme nulle. L'équation devient.

\begin{align}
y_{pv} &= 0\\
	d \cdot (R_{2} \cdot H_{1} + H_{2}) &= 0\\
	\rightarrow R_{2} &= \frac{-H_{2}}{H_{1}}\\
\end{align}


Le modèle de $H_{1}$  et $H_{2}$ étant le modèle de Vander Grinten Les fonction de transfert peuvent s'écrire :
\begin{equation}
H_{1} =  \frac{k_{1} \cdot e^{-sT_{m1}}}{(sT_{11} + 1) \cdot (sT_{12} + 1)}
\end{equation}

\begin{equation}
H_{2} =  \frac{k_{2} \cdot e^{-sT_{m2}}}{(sT_{21} + 1) \cdot (sT_{22} + 1)}
\end{equation}

On peut donc poser les relations suivantes :
\begin{align}
R_{2} &\rightarrow \frac{-k_{1}}{k_{2}} = gain\\
	  &\rightarrow e^{-s(T_{m1} - T_{m2})}\\
	  &\rightarrow \frac{(sT_{11} + 1) \cdot (sT_{12} + 1)}{(sT_{21} + 1) \cdot (sT_{22} + 1)}\\
\end{align}

\subsubsection{Condition pour implémenter le Feed Forward}
\begin{itemize}
\item Ordre de $H_{2}$ doit être égale à l'ordre de $H_{1}$
\item Le temps mort du régulateur 2 doit être plus faible que le temps de la perturbation sur la sortie (on doit calculer et agir sur la sortie au minimum en même temps que la perturbation si on veut la rendre invisible)
\item On doit pouvoir mesurer la perturbation
\end{itemize}

\subsection{Résultats expérimentaux}
\fig{FeedForword/Rising.png}{0.6}{Réponse du système à une variation du ventilateur de 50\% à 60\%}
\fig{FeedForword/Falling.png}{0.6}{Réponse du système à une variation du ventilateur de 60\% à 50\%}

\subsection{Observation}